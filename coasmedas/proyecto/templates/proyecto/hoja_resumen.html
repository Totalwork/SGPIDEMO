{% extends 'page.html' %}
{% load static %}
{% load humanize %}

{%block imports_css %}
  <link rel="stylesheet" type="text/css" href='{% static "assets/skin/default_skin/css/theme.css" %}'>
  <link rel="stylesheet" type="text/css" href='{% static "assets/skin/default_skin/css/theme2.css" %}'>
  <link rel="stylesheet" type="text/css" href='{% static "assets/skin/default_skin/css/theme3.css" %}'>
  <link rel="stylesheet" type="text/css" href='{% static "assets/admin-tools/admin-forms/css/admin-forms.css" %}'>
 <link rel="stylesheet" type="text/css" href='{% static "css/fileInput/fileinput.min.css" %}'>
 <link rel="stylesheet"  href='{% static "js/plugins/Bootstrap-Image-Gallery-3.1.1//css/blueimp-gallery.min.css" %}'> 
 <link rel="stylesheet"  href='{% static "js/plugins/Bootstrap-Image-Gallery-3.1.1//css/bootstrap-image-gallery.css" %}'>
 <link rel="stylesheet" type="text/css" href='{% static "js/plugins/datepicker/css/bootstrap-datetimepicker.css" %}'> 
 <link rel="stylesheet" href='{% static "js/plugins/vakata-jstree/dist/themes/default/style.min.css" %}'/>
{% endblock imports_css %}

{% block title %}Resumen del proyecto{% endblock title%}
{% block mapa %}
  &nbsp;&nbsp;&nbsp;
  <li><a href="/usuario/"><i class="glyphicon glyphicon-home"></i></a></li>
  <li><a href="{% url 'proyecto.resumen_proyecto' %}">Resumen</a></li>
  <li class="active">Hoja del proyecto</li>
{% endblock mapa %}


{% block encabezado %}
  <a href="{% url 'proyecto.resumen_proyecto'%}" data-placement="right"  
    data-toggle="tooltip" data-original-title="Regresar al listado de proyectos">
    <i class="fa fa-arrow-left" style="font-size: 20px;"></i>
  </a> 
  Resumen del Proyecto

{% endblock encabezado %}


{% block contenido %}

{% block opciones_listado %} {% endblock opciones_listado %}
{% block busqueda %}{% endblock busqueda %}


  <div class="row" ><br><br>

    <div class="row" >
      <div class="col-lg-5">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Datos iniciales del proyecto</span></div>
              <div class="modal-body">

                <strong>Contrato MME-OP : </strong>
                <span  data-bind="cutWord:{num:25,text:'{{empresa_proyecto.proyecto.mcontrato.nombre}}', verMax:'...', verMin:'...'}">
                </span><br>

                <strong>Nombre del Proyecto : </strong>
                <span data-bind="cutWord:{num:25,text:'{{empresa_proyecto.proyecto.nombre}}', verMax:'...', verMin:'...'}">
                </span><br>

                <strong>Estado del Proyecto : </strong><span>{{empresa_proyecto.proyecto.estado_proyecto.nombre}}</span><br>

              </div>
          </div>
      </div><!--col-lg-5" -->

      <div class="col-lg-1">
      </div>

      <div class="col-lg-6">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Ubicaci√≥n del proyecto</span></div>
              <div class="modal-body">

                <strong>Departamento  : </strong><span>{{empresa_proyecto.proyecto.municipio.departamento.nombre}}</span><br>
                <strong>Municipio  : </strong><span>{{empresa_proyecto.proyecto.municipio.nombre}}</span><br>
                
                <a href="{% url 'puntos.mapa' id_proyecto %}" >
                  <i class="fa fa-map-marker fa-2x"></i> 
                Ir al mapa</a>

              </div>
          </div>
      </div><!--col-lg-6" -->
    </div><!--ciera row-->


    <div class="row" >
      <div class="col-lg-5">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Responsables</span> </div>
            
              <div class="modal-body">

                <div id="mensaje_funcionario"></div>

                <div data-bind="visible:(listado_empresa()!=null && listado_empresa().length > 0)">

                  <!--ko foreach:{ data:listado_empresa, as:'item'} -->

                      <span data-bind="cutWord:{num:55,text:empresa__nombre, verMax:'...', verMin:'...'}"></span>

                        <a data-bind="click:function(){$root.ver_funcionarios_empresa({{id_proyecto}},item.empresa__id)}" data-toggle="modal" style="cursor:pointer;"><i class="fa fa-ellipsis-h fa-2x"></i></a>

                      <br><br>

                  
                  <!--/ko-->

                </div><!--cierra validacion-->

              </div>
          </div>
      </div><!--col-lg-5" -->


      <div class="col-lg-1">
    
      </div><!--col-lg-3" -->


      <div class="col-lg-3" style="padding-right:27px;">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Contratos</span></div>
              <div class="modal-body">

                 <strong>Contrato</strong>
                 <a  data-placement="top"  data-toggle="tooltip" title="" data-original-title="Ver contratos" data-bind="click:function(){ver_contratos({{id_proyecto}},{{user.usuario.empresa.id}})}" data-toggle="modal" style="cursor:pointer;"><i class="fa fa-archive fa-2x"></i></a>

              </div>   
          </div>
      </div><!--col-lg-3" -->


      <div class="col-lg-3">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Seguimientos</span></div>
              <div class="modal-body">

                
                {% if procesoProyecto.count == 0 %}

                  <div class="alert alert-warning alert-dismissable">
                    <i class="fa fa-warning"></i>No se encontraron registros
                  </div>

                {% endif %}

                {% if procesoProyecto.count > 0 %}

                  <table class="table">
                              
                    <thead>
                        <tr>
                          <th>Nombre proceso</th>
                          <th>Opcion</th>
                        </tr>
                    </thead>
                    <tbody>
                      {% for item in procesoProyecto %}
                      <tr>
                       
                        <td>{{item.proceso__nombre}}</td>
                        <td>
  <!--                            <a href="#" data-bind="attr:{href:'../../../../proceso/detalleSeguimientoProcesoDatos/' + {{item.id}} }">
                                <i class="fa fa-ellipsis-h fa-2x"></i>
                             </a> -->

                            <a  data-placement="top"  data-toggle="tooltip" title="" data-original-title="Ver procesos" data-bind="click:function(){ ver_mas_proceso({{item.proceso__id}},{{item.proceso__apuntador}},{{id_proyecto}}) }" data-toggle="modal" style="cursor:pointer;">

                              <i class="fa fa-ellipsis-h fa-2x"></i>
                            </a>
                        </td>

                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>

                {% endif %}

              </div>   
          </div>
      </div><!--col-lg-3" -->
    </div><!--cierra row -->


     <!--ver mas liquidacion de contrato-->
    <div id="vermas_liquidacion" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
          
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="font-size: 30px;font-weight: bold;"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
          </div>
          <div class="modal-body">

            <div data-bind="html: mensaje_listado_seguimiento"></div>  
            <div class="table-responsive" data-bind="visible:(listado_seguimiento()!=null && listado_seguimiento().length > 0)">

             <div class="col-lg-12">
                <div class="row">
                  <div class="progress">
                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-bind="text:porcentaje_seguimiento()+'%',attr:{'valuenow':porcentaje_se} ,style:{width: porcentaje_seguimiento() + '%'}"></div>

                  </div>              
                </div>
                <div class="row">
                  <i class="fa fa-bell "></i>:Por cumplir;
                  <i class="fa fa-bell text-success"></i>:Cumplido;
                  <i class="fa fa-bell text-warning"></i>:Por vencer;
                  <i class="fa fa-bell text-danger"></i>:Vencido;
                </div>  
              </div>

              <table class="table table-bordered mbn">
                <thead>
                    <tr>
                      <th></th>
                      <th>Actividad</th>
                      <th>Valor</th>
                      <th>Soporte</th>
                      <th>Observacion</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach:{data:listado_seguimiento, as:'item2'}">
                  <tr>
                    <td>

                      <!--ko if: item2.estado=='0' -->
                        <i class="fa fa-bell "></i>
                      <!--/ko -->

                      <!--ko if: item2.estado=='1' -->
                        <i class="fa fa-bell text-success"></i>
                      <!--/ko -->

                      <!--ko if: item2.estado=='2' -->
                        <i class="fa fa-bell text-warning"></i>
                      <!--/ko -->

                      <!--ko if: item2.estado=='3' -->
                        <i class="fa fa-bell text-danger"></i>
                      <!--/ko -->

                    </td>
                    <td data-bind="text: item2.item.descripcion"></td>
                    <td>
                      <!--ko if: item2.valor!='Vacio' -->
                        <span data-bind="text: item2.valor"></span>
                      <!--/ko -->
                    </td>
                    <td>

                      <a  data-placement="top"  data-toggle="tooltip" title="" data-original-title="Ver soportes" data-bind="click:function(){ $parent.ver_soporte_proceso(item2.id) }" data-toggle="modal" style="cursor:pointer;">
                        <i class="fa fa-paperclip fa-2x"></i>
                      </a>
                      <span data-bind="text: item2.cantidadSoportes"></span>

                    </td>
                    <td>
                      <!--ko if: item2.observacion!='undefined' &&  item2.observacion!=null &&  item2.observacion!=''-->
                        <span data-bind="text: item2.observacion"></span>
                      <!--/ko -->

                      <!--ko if: item2.observacion=='undefined' || item2.observacion==null || item2.observacion==''-->
                        No se encontro observacion
                      <!--/ko -->
                    </td>
                  </tr>                    
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
    <!--cierra liquidacion de contrato-->


    <!--ver mas soportes de proceso-->
    <div id="vermas_soportes_proceso" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
          
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="font-size: 30px;font-weight: bold;"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
          </div>
          <div class="modal-body">

            <div data-bind="html: mensaje_listado_soportes"></div>  
            <div class="table-responsive" data-bind="visible:(listado_soportes()!=null && listado_soportes().length > 0)">

              <table class="table table-bordered mbn">
                <thead>
                    <tr>      
                      <th></th>
                      <th>Documento</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach:{data:listado_soportes, as:'item'}">
                  <tr>
 
                    <td>
                        <a data-bind="attr: {href: '/proceso/ver-soporte/?id=' + item.id}" target="_blank" style="cursor:pointer;">
                          <i class="fa fa-paperclip fa-2x"></i>
                        </a>
                    </td>
                    <td data-bind="text: item.nombre"></td>

                  </tr>                    
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
    <!--cierra ver mas soportes de procesos-->


    {% if cronograma.count > 1 %}
    <div class="row" >
      <div class="col-lg-12">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Avance de obra</span></div>
              <div class="modal-body">

                <div class="form-group">
                  <label>Cronograma</label>

                    <select class="form-control" id="contratista_filtro" name="contratista_filtro" data-bind="value:cronograma_select">
                        <option value="0">[Seleccione...]</option>
                        {% for item in cronograma  %}
                          <option value="{{item.id}}"> {{item.nombre}}</option>
                        {% endfor %}

                    </select>

                </div>
              </div>
          </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row-->
    {% endif %}


    <div class="panel mb25 mt5">
      <div class="panel-heading">
        <span class="panel-title hidden-xs">Graficas Avance de Obra</span>
        <ul class="nav panel-tabs-border panel-tabs">
          <li class="active"> <a href="#tab1_1" data-toggle="tab">Historial de avance fisico</a></li>
          <li><a href="#tab1_2" data-toggle="tab">Avance de Obra por Hito </a></li>              
        </ul>
      </div>

      <div class="panel-body p20 pb10">
        <div class="tab-content pn br-n admin-form">
          <div id='loading2' style="display: none;">
            <div class="pop-fondo"></div><img class="pop-imagen" src='{% static "css/images/iconoCargando.gif" %}')>
          </div>
          <div id="tab1_2" class="tab-pane">
            <div class="col-lg-12">
              <div class="panel">
                <div class="panel-heading" style="background:#4a89dc;">
                  <span class="panel-title text-white">Avance de obra por hito</span>
                </div>
                <div id="grafica" class="panel-body">
                  <div data-bind="foreach:{data:porcentajes, as:'item'}">
                    <div >
                      <div class="col-md-3 text-center mb10">
                        <div class="info-circle" style="width: 100%;" data-bind="attr:{'id':'cr'+item.id ,'title':item.actividad, value:item.porcentaje}" data-circle-color="primary">
                        </div>
                      </div>
                    </div>                      
                  </div>
                </div>
              </div>                
            </div>            
          </div><!--cierra tap 1-->

          <div id="tab1_1" class="tab-pane active">
            <div class="col-lg-12">
              <div class="panel">
                <div class="panel-heading" style="background:#4a89dc;">
                  <span class="panel-title text-white">Historial de avance fisico</span>
                </div>
                <div class="panel-body">
                  <!--Inicio grafica de avance fisico-->
                  <div id="high-line3" style="width: 100%; height: 310px; margin: 0 auto"></div>
                  <!--Fin grafica de avance fisico-->      
                </div>
              </div>
            </div>          
          </div><!--cierra tap 2-->
        </div>
      </div>      
    </div><!--cierra panel mb25 mt5 -->   



    {% if 'giros.can_see_seguimiento' in perms %}
    <div class="row" >
      <div class="col-lg-12">

          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Seguimientos de giros</span></div>

              <div class="modal-body">

                <div data-bind="html: mensaje_proyecto_contrato"></div>

                <div data-bind="visible:(listado_contrato_proyecto()!=null && listado_contrato_proyecto().length > 0)">    

                  <div class="table-responsive">

                    <table class="table" >
                      <thead>
                        <tr>
                          <th>Nombre proceso</th>
                          <th>Numero</th>
                          <th>Nombre del contrato</th>
                          <th>Elemento</th>
                          <th>Opcion</th>
                        </tr>
                      </thead>

                      <tbody data-bind="foreach:{data:listado_contrato_proyecto, as:'item'}">
                        <tr>
                          <td data-bind="text: item.nombre_proceso"></td>
                          <td data-bind="text: item.numero_contrato"></td>
                          <td data-bind="text: item.nombre_contrato"></td>
                          <td data-bind="text: item.validacion"></td>
                          <td>

                            <!--ko if: item.proceso_id !='' -->

                             <a href="#" data-bind="attr:{href:'../../../../sinin4/proceso/detalleSeguimientoProcesoDatos/' + item.proceso_id }">
                                <i class="fa fa-ellipsis-h fa-2x"></i>
                             </a>

                             <!--/ko -->

                          </td>
                        </tr>
                         
                      </tbody>
                    </table>
           
                  </div>
                </div><!--cierra validacion-->
              </div>
          </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row-->
    {% endif %}



    <div class="row" >
      <div class="col-lg-12">
    
          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Actas de replanteo y liquidaci√≥n</span></div>

              <div class="modal-body">

                <div data-bind="html: mensaje_actas_replanteo"></div>

                <div class="table-responsive" data-bind="visible:(listado_actas_replanteo()!=null && listado_actas_replanteo().length > 0)">    

                  <div class="table-responsive">

                    <table class="table" >
                      <thead>
                          <tr>
                            <th>Contrato</th>
                            <th>No. contrato</th>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Soporte</th>
                          </tr>
                      </thead>

                      <tbody data-bind="foreach:{data:listado_actas_replanteo, as:'item'}">
                        <tr>

                          <td data-bind="text: item.nombre_contrato"></td>
                          <td data-bind="text: item.numero_contrato"></td>
                          <td data-bind="text: item.tipo_nombre"></td>
                          <td data-bind="text: formatMoney(item.valor)"></td>
                          <td>

                                <a data-bind="attr: {href: '/contrato/ver-soporte/?id=' + item.id}" 
                                target="_blank" style="cursor:pointer;">
                                   <i class="fa fa-paperclip fa-2x"></i>
                                </a>

                          </td>

                        </tr>
                         
                      </tbody>
                    </table>
           
                  </div>

                </div><!--cierra validacion-->
              </div>
          </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row-->


    <div class="row">
      <div class="col-lg-12">
      
          <div class="panel" id="spy4">
              <!-- PANEL TITULO Y ICONOS -->  
              <div class="panel-heading">
                  <!-- <center><h4>Directorio de Archivos</h4></center> -->
                  <span class="panel-title"> Archivos asociados al proyecto </span> 
                   <div class="pull-right"  style="margin-right: 63%;">       
                      
                    <button data-bind="click:$root.descarga_archivo" class="btn btn-default" type="button" title="Descargar archivo" data-toggle="tooltip" data-placement="top" >
                        <span class="fa-stack fa-lg" style="color: #428bca;"  >                    
                          <i class="fa fa-cloud-download fa-2x"></i>
                        </span> 
                    </button>

                    <!-- <button data-bind="click:$root.abrir_modal_filtro"  class="btn btn-default" type="button" title="Consultar archivos asociados a contratos o proyectos" data-toggle="tooltip" data-placement="top" >
                      <span class="fa-stack fa-lg" style="color: #428bca;"  >                    
                          <i class="fa  fa-filter fa-2x"></i>
                      </span> 
                    </button> -->
                  </div>
              </div>

              <div class="panel-body" >
                <div class="col-lg-3"  style="resize: both; height:500px; overflow: scroll;" >
                    <label>&nbsp;&nbsp;Directorio</label> 
                    <div id="jstree" style="border-style:none; "></div>
                </div> 
          
                <div class="col-lg-9" style="resize: both; height:500px; overflow: scroll;">        
                     <br>
                     <div data-bind="html: mensaje"></div> 
                    <div data-bind="visible:(listado_archivos()!=null && listado_archivos().length > 0)">
                          <div class="table-responsive" >
                                <table class="table">
                                    <thead>
                                    <tr>
                                      <th width="3%"><input type="checkbox" data-bind="checked:checkall" class="fom-control"  > </th>
                                      <th width="35%">Nombre</th>    
                                      <!-- <th width="10%">Peso</th> -->
                                      <th width="25%">Fecha</th>
                                      <th width="32%">Modificado</th>
                                      <!-- <th width="5%">Tipo</th> -->
                                    </tr>
                                  </thead>
                                  <tbody data-bind="foreach:{data:listado_archivos, as:'item'}">
                                    <tr data-bind="event :{dblclick:$root.dobleclick}"  style="cursor:pointer" >
                                      <td><input type="checkbox" data-bind="checked:eliminado,value:id" class="fom-control"  > </td> 
                                      <td > 
                                        <span data-bind="css : item.icono+' fa-2x' ,style:{color:item.color}" ></span>
                                        <span data-bind="text:item.nombre" ></span>
                                      </td> 
                                      <td data-bind="text: item.fechaModificado"></td>
                                      <td data-bind="text: item.usuarioModificado"></td>
                                    </tr>
                                  </tbody>
                                </table>
                                <br><br><br><br><br><br>
                          </div>              
                   </div>
                </div> 
              </div>
          </div>
        </div><!--col-lg-3" -->
    </div><!--cierra row -->


    <div class="row">
      <div class="col-lg-12">
  
        <div class="panel" id="spy4">
          <div class="panel-heading"><span class="panel-title"></span><span>Datos tecnicos</span></div>
            <div class="modal-body">

              {% if datos_tecnicos.count == 0 %}

                <div class="alert alert-warning alert-dismissable">
                  <i class="fa fa-warning"></i>No se encontraron registros
                </div>

              {% endif %}

              {% if datos_tecnicos.count > 0 %}

                <table class="table">
                            
                  <thead>
                      <tr>
                        <th>Unidad Medida</th>
                        <th>Nombre</th>
                        <th>Valor Dise√±o</th>
                        <th>Valor Replanteo</th>
                        <th>Valor Ejecuci√≥n</th>
                      </tr>
                  </thead>
                  <tbody>
                    {% for item in datos_tecnicos %}
                    <tr>
                      <td>{{item.campo.unidad_medida}}</td>
                      <td>{{item.campo.nombre}}</td>
                      <td>{{item.valor_diseno}}</td>
                      <td>
                        {% if item.valor_replanteo %}
                          {{item.valor_replanteo}}
                        {% endif %}

                        {% if item.valor_replanteo == None %}
                          Por Asignar
                        {% endif %}
                      </td>
                      <td>
                        {% if item.valor_ejecucion %}
                          {{item.valor_ejecucion}}
                        {% endif %}

                        {% if item.valor_ejecucion == None %}
                          Por Asignar
                        {% endif %}                  
                      </td>

                    </tr>
                    {% endfor %}
                  </tbody>
                </table>

              {% endif %}

            </div>
        </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->

    <div class="row">
      <div class="col-lg-12">
    
          <div class="panel" id="spy4">
            <div class="panel-heading"><span class="panel-title"></span><span>Giros</span></div>

              <div class="modal-body">

                <div data-bind="html: mensaje_giros_contrato"></div>

                <div data-bind="visible:(listado_giros_contrato()!=null && listado_giros_contrato().length > 0)">    

                  <div class="table-responsive">

                    <table class="table" >
                      <thead>
                        <tr>
                          <th>Contrato</th>
                          <th>No. contrato</th>
                          <th>Nombre del giro</th>
                          <th>Monto</th>
                          <th></th>
                        </tr>
                      </thead>

                      <tbody data-bind="foreach:{data:listado_giros_contrato, as:'item'}">
                        <tr>

                          <td data-bind="cutWord:{num:25,text:item.nombre_contrato, verMax:'...', verMin:'...'}"></td>
                          <td data-bind="text: item.numero_contrato"></td>
                          <td data-bind="text: item.nombre_giro"></td>
                          <td data-bind="text: formatMoney(item.monto)"></td>
                          <td>
                             <a href="#" data-bind="attr:{href:'../../../giros/detalle_giro_lectura/' + item.id_giro +'/'+item.nombre_contrato_id +'/'+item.contrato_id}" target="_blank">
                                 <i class="fa fa-ellipsis-h fa-2x"></i>

                              </a>
                          </td>

                        </tr>

                                      
                      </tbody>
                    </table>

                    <h2>Total Giros : <span data-bind="text:formatMoney({{total_giros}})"></span></h2>
           
                  </div>

                </div><!--cierra validacion-->

              </div>

          </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->


    <div class="row">
      <div class="col-lg-12">
  
        <div class="panel" id="spy4">
          <div class="panel-heading"><span class="panel-title"></span><span>Correspondencia</span></div>
            <div class="modal-body">

              <div id="mensaje_correspondencia"></div> 

              <div class="table-responsive" data-bind="visible:(listado_correspondencia()!=null && listado_correspondencia().length > 0)">

                <table class="table" >
                  <thead>
                      <tr>
                        <th width="5%" >Soporte</th>
                        <th width="9%" >Consecutivo</th>
                        <th width="15%" >Empresa</th>
                        <th width="40%" >Asunto</th>
                        <th width="20%" >Firma</th>
                        <th width="11%" >Fecha envio</th>
                      </tr>
                  </thead>

                  <tbody data-bind="foreach:{data:listado_correspondencia, as:'item'}">
                    <tr>
                      <td>

                          <a href="#" data-bind="click:$root.ver_soportes_correspondencia">
                              ver soportes
                          </a>

                      </td>
                      <td data-bind="text: item.prefijo__nombre+' - '+item.consecutivo"></td>
                      <td data-bind="text: item.empresa__nombre"></td>
                      <td data-bind="text: item.asunto"></td>
                      <td>
                          <span data-bind="text: item.firma__persona__nombres"></span>
                          <span data-bind="text: item.firma__persona__apellidos"></span>
                      </td>
                      <td data-bind="text: item.fechaEnvio"></td>

                    </tr>
                     
                  </tbody>
                </table>
       
              </div>

            </div>   
        </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->


    <div class="row">
      <div class="col-lg-12">
        <div class="panel" id="spy4">
          <div class="panel-heading"><span>Registro fotografico</span></div>
            <div class="panel-body">

           
<!--               <div class="col-lg-12">
                  <a  href="{% url 'administrador_fotos.fotosProyecto' id_proyecto %}" data-placement="top"  data-toggle="tooltip" title="" data-original-title="Cargar fotos"  data-toggle="modal" style="cursor:pointer;" target="_blank">
                    <i class="fa fa-upload fa-2x"></i>
                  </a>

              </div><br><br> -->
            
              <div class="col-lg-4"><!--INICIO DE FOTOS ANTES--> 
                <div class="panel" id="spy4">
                  <div class="panel-heading"><span>Antes del proyecto</span></div>
                    <div class="panel-body">

                      <div class="col-lg-12">

                        <div class="row">

                          {% for item in fotos_antes %}

                          <a data-gallery="" href="{{ item.ruta_publica }}" target="_blank" style="cursor:pointer;">
                              <img src="{{ item.ruta_publica }}" height="40" width="40">
                          </a>

                          {% endfor %}

                        </div><!--cierra row-->

                        {% if fotos_antes.count == 0 %}

                          <div class="alert alert-warning alert-dismissable">
                            <i class="fa fa-warning"></i>No se encontraron fotos para mostrar
                          </div>
                        {% endif %}

                      </div>          
                    </div>
                </div>              
              </div><!--FIN DE FOTOS ANTES-->

              <div class="col-lg-4"><!--INICIO DE FOTOS DURANTE--> 
                <div class="panel" id="spy4">
                  <div class="panel-heading"><span>Durante del proyecto</span></div>
                    <div class="panel-body">

                      <div class="col-lg-12">

                        <div class="row">

                          {% for item in fotos_durante %}

                            <a data-gallery="" href="{{ item.ruta_publica }}" target="_blank" style="cursor:pointer;">
                                <img src="{{ item.ruta_publica }}" height="40" width="40">
                            </a>

                          {% endfor %}

                        </div><!--cierra row-->

                        {% if fotos_durante.count == 0 %}

                          <div class="alert alert-warning alert-dismissable">
                            <i class="fa fa-warning"></i>No se encontraron fotos para mostrar
                          </div>
                        {% endif %}

                      </div>                    
                    </div>
                </div>              
              </div><!--FIN DE FOTOS DURANTE--> 

              <div class="col-lg-4"><!--INICIO DE FOTOS DESPUES--> 
                <div class="panel" id="spy4">
                  <div class="panel-heading"><span>Despues del proyecto</span></div>
                    <div class="panel-body">
                      <div class="col-lg-12">
                        
                        <div class="row">

                          {% for item in fotos_despues %}

                            <a data-gallery="" href="{{ item.ruta_publica }}" target="_blank" style="cursor:pointer;">
                                <img src="{{ item.ruta_publica }}" height="40" width="40">
                            </a>

                          {% endfor %}

                        </div><!--cierra row-->

                        {% if fotos_despues.count == 0 %}

                          <div class="alert alert-warning alert-dismissable">
                            <i class="fa fa-warning"></i>No se encontraron fotos para mostrar
                          </div>
                        {% endif %}

                      </div>                    
                    </div>
                </div>              
              </div><!--FIN DE FOTOS DESPUES-->

            </div>
         </div> 
      </div><!--cierra-col-12-->
    </div><!--cierra-row-->


    <!--Fotos subcategoria-->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel" id="spy4">
          <div class="panel-heading"><span>Registro fotografico por categoria</span></div>
            <div class="panel-body">

              <div data-bind="html: mensaje_categoria"></div>
              <div class="col-sm-3" data-bind="visible:(listado_categoria()!=null && listado_categoria().length > 0)">
                <div class="panel" id="spy4">
                  <div class="panel-heading"><span>Categorias</span></div>
                    <div class="panel-body">

                      <table class="table table-bordered mbn" >
                        <thead>
                            <tr>
                              <th>
                                  <div class="option-group field admin-form">
                                    <label class="option option-primary"  style="">
                                      <input type="checkbox" data-bind="checked:checkallcategoria">
                                      <span class="checkbox"></span>
                                    </label>
                                  </div>
                              </th>
                              <th>Categoria</th>
                            </tr>
                        </thead>

                        <tbody data-bind="foreach:{data:listado_categoria, as:'item'}">
                          <tr>
                            <td> 
                                <div class="option-group field admin-form">
                                  <label class="option option-primary"  style="">
                                    <input type="checkbox" data-bind="checked:eliminado,value:id,click:$root.consultar_subcategoria">
                                    <span class="checkbox"></span>
                                  </label>
                                </div>
                            </td> 
                            <td data-bind="text: item.categoria"></td>
                          </tr>
                       
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div><!--cierra col sm3-->

                <div class="col-sm-3">
                  <div class="panel" id="spy4" data-bind="visible:(listado_subcategoria()!=null && listado_subcategoria().length > 0)">
                    <div class="panel-heading"><span>Sub Categorias</span></div>
                      <div class="panel-body">

                        <table class="table">
                          <thead>
                              <tr>
                                <th>
                                  <div class="option-group field admin-form">
                                    <label class="option option-primary"  style="">
                                      <input type="checkbox" data-bind="checked:checkallSubcategoria">
                                      <span class="checkbox"></span>
                                    </label>
                                  </div>
                                </th>
                                <th>Titulo</th>
                                <th>Contenido</th>
                              </tr>
                          </thead>

                          <tbody data-bind="foreach:{data:listado_subcategoria, as:'item'}">
                            <tr>
                              <td>
                                  <div class="option-group field admin-form">
                                    <label class="option option-primary"  style="">
                                       <input type="checkbox" data-bind="checked:eliminado,value:id,click:$root.consultar_fotos_subcategoria">
                                      <span class="checkbox"></span>
                                    </label>
                                  </div> 
                              </td> 
                              <td data-bind="text: item.titulo"></td>
                              <td data-bind="text: item.contenido"></td>
                            </tr>
                             
                          </tbody>
                        </table>
                      </div>
                  </div>
                </div><!--cierra col sm3-->

                <div class="col-sm-3">
                  <div class="panel" id="spy4" data-bind="visible:(listado_subcategoria()!=null && listado_subcategoria().length > 0)">
                    <div class="panel-heading"><span>Periodo</span></div>
                      <div class="panel-body">

                        <input class="form-control" type="text" placeholder="Seleccione la fecha desde" 
                                data-bind="datePicker:desde,value:desde,
                                event:{ change: consultar_fotos_subcategoria}, 
                                dateTimePickerOptions:{maxDate:new Date()}" onkeypress="return false"><br>

                        <input class="form-control" type="text" placeholder="Seleccione la fecha hasta" 
                                data-bind="datePicker:hasta,value:hasta,
                                event:{ change: consultar_fotos_subcategoria}, 
                                dateTimePickerOptions:{maxDate:new Date()}" onkeypress="return false">
                       
                      </div>
                  </div>
                </div><!--cierra col sm3-->


                <div class="col-sm-3">
                  <div class="panel" id="spy4" data-bind="visible:(listado_fotos_subcategoria()!=null && listado_fotos_subcategoria().length > 0)">
                    <div class="panel-heading"><span>Fotos subcategorias</span></div>
                      <div class="panel-body">
                        <div class="col-lg-12">
                        
                          <div class="row">

                            <!--ko foreach:{ data:listado_fotos_subcategoria, as:'item'} -->

                              <a data-gallery="" data-bind="attr: {href: item.ruta}" target="_blank" style="cursor:pointer;">
                                <img data-bind='attr:{src:item.ruta}' height="40" width="40">
                              </a>

                            <!--/ko -->

                          </div><!--cierra row-->

                        </div>                    
                      </div>
                  </div>
                </div><!--cierra col sm3--> 

            </div>
         </div> 
      </div><!--cierra-col-12-->
    </div><!--cierra-row-->



    <div class="row">
      <div class="col-lg-12">

        <div class="panel" id="spy4">
          <div class="panel-heading"><span class="panel-title"></span><span>Descargos</span>
              <span data-bind="text:'- N¬∞ de Registros: ' + paginacion.totalRegistrosBuscados() + ' de ' + paginacion.total()"></span>

              <span class="panel-controls">
                <a  data-placement="top"  data-toggle="tooltip" title="" data-original-title="Filtrar descargos" data-bind="click:filtrar_estado" data-toggle="modal" style="cursor:pointer;">
                    <i class="fa fa-filter fa-2x"></i>
                </a>
              </span>

          </div>
          
            <div class="modal-body">

              <div data-bind="html: mensaje_descargo"></div>

                <div data-bind="visible:(listado()!=null && listado().length > 0)">      

                  <div class="table-responsive">

                    <table class="table" >
                      <thead>
                        <tr>
                          <th>Estado</th>
                          <th>Fecha</th>
                          <th>Id</th>
                          <th>No. Descargo  </th>
                          <th>Contrato</th>
                          <th>Maniobra</th>
                          <th>Trabajo</th>
                          <th>Observaci√≥n</th>
                        </tr>
                      </thead>

                      <tbody data-bind="foreach:{data:listado, as:'item'}">
                        <tr>
                          <td data-bind="text: item.estado.nombre"></td>
                          <td data-bind="text: item.fecha"></td>
                          <td data-bind="text: item.id_interno"></td>
                          <td data-bind="text: item.numero"></td>
                          <td data-bind="text: item.proyecto.mcontrato.nombre"></td>
                          <td data-bind="text: item.maniobra.nombre"></td>
                          <td data-bind="text: item.trabajo[0].nombre"></td>
                          <td>
                           <!--ko if: item.observacion!='NULL' &&  item.observacion!=''-->
                            <span data-bind="text: item.observacion"></span>
                           <!--/ko -->
                          </td>

                        </tr>
                         
                      </tbody>
                    </table>
           
                  </div>

                    <div id="paginacion" >
                      <div data-bind="pagination: {
                                    currentPage: paginacion.pagina_actual,
                                    totalCount: paginacion.total,
                                    pageSize:paginacion.cantidad_por_paginas,
                                    maxPages: paginacion.maxPaginas,
                                    directions: paginacion.direcciones,
                                    boundary: paginacion.limite,
                                    text: paginacion.text }">

                      </div>
                    </div>
                </div><!--cierra validacion-->

            </div>

        </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->

    
    <div class="row">
      <div class="col-lg-12">
      
        <div class="panel" id="spy4">
          <div class="panel-heading"><span class="panel-title"></span><span>Poliza</span></div>

            <div class="modal-body">

              <div data-bind="html: mensaje_poliza_contrato"></div>

              <div data-bind="visible:(listado_poliza_contrato()!=null && listado_poliza_contrato().length > 0)">    

                <div class="table-responsive">

                  <table class="table" >
                    <thead>
                      <tr>
                          <th>Contrato</th>
                          <th>No. contrato</th>
                          <th>Tipo de poliza</th>
                          <th>Fecha de inicio</th>
                          <th>Fecha fin</th>
                          <th>Valor</th>
                      </tr>
                    </thead>

                    <tbody data-bind="foreach:{data:listado_poliza_contrato, as:'item'}">
                      <tr>
                        <td data-bind="text: item.nombre_contrato"></td>
                        <td data-bind="text: item.numero_contrato"></td>
                        <td data-bind="text: item.poliza_nombre"></td>
                        <td data-bind="text: item.fecha_inicio"></td>
                        <td data-bind="text: item.fecha_final"></td>
                        <td data-bind="text: formatMoney(item.valor)"></td>

                      </tr>
                               
                    </tbody>
                  </table>
         
                </div>

              </div><!--cierra validacion-->

            </div>

        </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->

    <div class="row">
      <div class="col-lg-12">
  
        <div class="panel" id="spy4">
          <div class="panel-heading"><span class="panel-title"></span><span>Actas de suspensi√≥n y reinicio</span></div>

            <div class="modal-body">

              <div data-bind="html: mensaje_vigencia_contrato"></div>

              <div data-bind="visible:(listado_vigencia_contrato()!=null && listado_vigencia_contrato().length > 0)">    

                <div class="table-responsive">

                  <table class="table" >
                    <thead>
                      <tr>
                          <th></th>
                          <th>Contrato</th>
                          <th>No. contrato</th>
                          <th>Operaci√≥n</th>
                          <th>Desde</th>
                          <th>Hasta</th>
                      </tr>
                    </thead>

                    <tbody data-bind="foreach:{data:listado_vigencia_contrato, as:'item'}">
                      <tr>
                        <td>

                            <a data-bind="attr: {href: '/contrato/ver-soporte/?id=' + item.id}" 
                            target="_blank" style="cursor:pointer;">
                               <i class="fa fa-paperclip fa-2x"></i>
                            </a>

                        </td>
                        <td data-bind="text: item.nombre_contrato"></td>
                        <td data-bind="text: item.numero_contrato"></td>
                        <td data-bind="text: item.operacion"></td>
                        <td data-bind="text: item.desde"></td>
                        <td data-bind="text: item.hasta"></td>

                      </tr>
                               
                    </tbody>
                  </table>
         
                </div>

              </div><!--cierra validacion-->

            </div>

        </div>
      </div><!--col-lg-12" -->
    </div><!--cierra row -->


    <!--Modal filtrar los descargos-->

  <div id="modal_filtro_descargo" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <label>Estados</label>
                <select class="form-control" id="estado_filtro" name="estado_filtro">
                  <option value="0">[Seleccione...]</option>
                    <!--ko foreach:{ data:lista_estado_select, as:'item'} -->
                    <option data-bind="value:item.id,text:item.nombre"></option>
                    <!--/ko-->
              </select>
            </div>

          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-bind="click:function(){consultar(1);}">
              <i class="fa fa-search"></i> Filtrar
            </button>
          </div>

      </div>
    </div>
  </div><!--cierra modal_filtro-->


    <!--Modal ver contratos-->

  <div id="ver_contratos" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
          </div>
          <div class="modal-body">

            <span data-bind="foreach:{data:listado_contrato, as:'item'}">

               <strong>Tipo de contrato : </strong><span data-bind="text:item.tipo_contrato.nombre"></span><br>
               <strong>Nombre del contrato : </strong><span data-bind="text:item.nombre"></span><br>
               <strong>Fecha de inicio : </strong><span data-bind="text:item.fecha_inicio"></span><br>
               <strong>Nombre del contratista : </strong><span data-bind="text:item.contratista.nombre"></span><br>
               <strong>Fecha de vencimiento : </strong><span data-bind="text:item.fecha_fin"></span><br>
               <strong>Estado : </strong><span data-bind="text:item.estado.nombre"></span><br>
               <strong>Numero del contrato : </strong><span data-bind="text:item.numero"></span><br>

                <a href="#" data-bind="attr:{href:'../../../contrato/historial-contrato/' + item.id}" target="_blank">
                  <i class="fa fa-clock-o fa-2x"></i> Ver Historial
                </a>

               <hr></hr>

            </span>

          </div>
      </div>
    </div>
  </div><!--cierra modal_contratos->

  <!--Fin del modal de filtro-->



      <!--Modal ver funcionarios-->

  <div id="ver_funcionarios" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
          </div>
          <div class="modal-body">

            <span data-bind="foreach:{data:listado_funcionario_empresa, as:'item'}">

              <span data-bind="text:item.persona__nombres"></span>
              <span data-bind="text:item.persona__apellidos"></span><br>
              <strong><span data-bind="text:item.cargo__nombre"></span></strong><br>
              <span data-bind="text:item.persona__correo"></span><br>  

               <hr></hr>

            </span>

          </div>
      </div>
    </div>
  </div><!--cierra modal funcionario->

  
  <!--Modal listado de soportes de correspondencia-->
  <div id="vermas_soportes_correspondencia" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="font-size: 30px;font-weight: bold;"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="gridModalLabel" data-bind='text:titulo'></h4>
        </div>
          <div class="modal-body">

            <div data-bind="html: mensaje_soporte_correspondencia"></div>  

            <div class="table-responsive" data-bind="visible:(listado_soporte_correspondencia()!=null && listado_soporte_correspondencia().length > 0)">

              <table class="table" >
                <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Soporte</th>                 
                    </tr>
                  </thead>

                  <tbody data-bind="foreach:{data:listado_soporte_correspondencia, as:'item'}">
                    <tr>
                      <td data-bind="text: item.nombre"></td>
                      <td>

                          <!--ko if: item.soporte!='' && item.soporte!=null-->
                              <a data-bind="attr: {href: '/correspondencia/ver-soporte/?id=' + item.id}" 
                              target="_blank" style="cursor:pointer;">
                                <i class="fa fa-file-text-o fa-2x"></i>
                              </a><br>
                          <!--/ko-->   

                      </td>

                    </tr>
                     
                  </tbody>
                </table>
       
              </div><!--cierra responsive-->

          </div>
      </div>
    </div>
  </div><!--fin modal listado de correspondencia-->


  <input type="hidden" value="{{user.usuario.empresa.id}}" id="empresa" name="empresa"/>


  <div id="blueimp-gallery" class="blueimp-gallery">
    <!-- The container for the modal slides -->
    <div class="slides"></div>
      <!-- Controls for the borderless lightbox -->
      <h3 class="title"></h3>
        <a class="prev">‚Äπ</a>
        <a class="next">‚Ä∫</a>
        <a class="close">√ó</a>
        <a class="play-pause"></a>
        <ol class="indicator"></ol>
        <!-- The modal dialog, which will be used to wrap the lightbox content -->
        <div class="modal fade">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header"><h4 class="modal-title"></h4></div>
                <div class="modal-body next"></div>
                  <div class="modal-footer">
                    
                    <button type="button" class="btn btn-default pull-left prev">
                      <i class="fa fa-chevron-left"></i>
                      Atras
                    </button>
                    <button type="button" class="btn btn-primary next">
                      Siguiente
                      <i class="fa fa-chevron-right"></i>
                    </button>

                  </div>
              </div>
            </div>
        </div>
  </div><!-- cierra blueimp-gallery-->


<!-- INICIA FILA CONSULTAR ARCHIVOS ASOCIADOS A PROYECTOS O CONTRATOS -->
<div id="modal_acciones_filtro" class="modal fade " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog ">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="gridSystemModalLabel">Consultar archivos asociados a contratos o proyectos</h4>
      </div>
      <div class="modal-body">
          <div class="container-fluid">  

            <div class="col-lg-12">
              <label>Nombre del archivo √≥ carpeta</label>
              <input  placeholder="Indique  el nombre del archivo √≥ carpeta" type="text" class="form-control" 
                id="txtBuscarContratoProyecto" >
            </div>                           
          </div>                            
      </div>
      <div class="modal-footer">  
        <button class="btn btn-primary"  data-bind="click:consultarContratoProyecto_btn">Consultar</button>
      </div>  
    </div>
  </div>
</div>
<!-- FINALIZA CONSULTAR ARCHIVOS ASOCIADOS A PROYECTOS O CONTRATOS -->


<!--Loading-->
  
{% endblock contenido %}

{% load static %}

{%block imports %}
  <script src='{% static "vendor/plugins/sparkline/jquery.sparkline.min.js" %}'></script>
  <script src='{% static "vendor/plugins/highcharts/highcharts.js" %}'></script>
  <script src='{% static "vendor/plugins/circles/circles.js" %}'></script>
  <script src='{% static "js/plugins/globalize/globalize.min.js" %}'></script>
  <script src='{% static "js/plugins/moment/moment.min.js" %}'></script>
  <script src='{% static "js/plugins/Bootstrap-Image-Gallery-3.1.1/js/jquery.blueimp-gallery.min.js" %}'></script>
  <script src='{% static "js/plugins/Bootstrap-Image-Gallery-3.1.1/js/bootstrap-image-gallery.js" %}'></script>
  <script type="text/javascript" src='{% static "js/plugins/vakata-jstree/dist/jstree.min.js" %}'></script>
  <script src='{% static "js/plugins/accounting/accounting.min.js" %}'></script>  
  <script type="text/javascript" src='{% static "js/plugins/datepicker/js/bootstrap-datetimepicker.js" %}'>
  </script>

  <script type="text/javascript" src='{% static "js/plugins/fileInput/fileinput.js" %}'></script>

  <script type="text/javascript" src='{% static "js/ViewModels/proyecto/resumen_proyecto.js" %}?v=2'></script>

  <script type="text/javascript">

    $(document).ready(function () {

      resumen.proyecto({{id_proyecto}});
      resumen.consultar(1);//iniciamos la primera funcion
      resumen.consultar_contrato_proyecto({{id_proyecto}});
      resumen.consultar_lista_estado();
      resumen.consultar_empresa({{id_proyecto}});//listado empresa responsable
      resumen.consultar_cantidad_cronograma({{id_proyecto}});//consulta el cronograma segun el id del proyecto
      resumen.consultar_correspondencia({{id_proyecto}});
      
      resumen.consultar_giros_contrato({{id_proyecto}});
      resumen.consultar_poliza_contrato({{id_proyecto}});
      resumen.consultar_vigencia_contrato({{id_proyecto}},1);
      resumen.consultar_vigencia_contrato({{id_proyecto}},2);
      resumen.consultar_categoria({{id_proyecto}});
      resumen.getIdCronograma({{id_proyecto}});

      /*archivos*/

      $.jstree.defaults.core.themes.variant = "large";
        // 6 create an instance when the DOM is ready 
        // 7 bind to events triggered on the tree
      $('#jstree').on("changed.jstree", function (e, data) {
        id_archivo=data.selected[0];
        if(typeof  id_archivo != 'undefined'){
            resumen.consultarContratoProyecto();                                   
        }else{

        }            
      }); 
      /*id_proyecto
      empresa_proyecto.proyecto.mcontrato.id*/
      resumen.proyecto_id({{id_proyecto}});
      resumen.m_contrato_id({{empresa_proyecto.proyecto.mcontrato.id}});
      resumen.consultar_arbol()/*crear arbol*/
      resumen.consultarContratoProyecto();/*listado de archivos*/

    });  

  </script>

{% endblock imports %}
